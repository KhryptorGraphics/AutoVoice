# ===========================================================================================
# PyTorch Installation (REQUIRED - Install separately before using this requirements.txt)
# ===========================================================================================
# PyTorch must be installed separately with CUDA support from the official PyTorch index.
# This file does not manage torch/torchaudio/torchvision to avoid version conflicts.
#
# OPTION 1 - Use curated requirements file (RECOMMENDED for CUDA 12.1):
#   pip install -r requirements-cu121.txt --index-url https://download.pytorch.org/whl/cu121
#
# OPTION 2 - Manual installation (Python 3.12 + CUDA 12.1):
#   pip install torch==2.5.1 torchvision==0.20.1 torchaudio==2.5.1 \
#     --index-url https://download.pytorch.org/whl/cu121
#
# OPTION 3 - Use setup script (automated):
#   ./scripts/setup_pytorch_env.sh
#
# Alternative (conda):
#   conda install pytorch==2.5.1 torchvision==0.20.1 torchaudio==2.5.1 \
#     pytorch-cuda=12.1 -c pytorch -c nvidia
#
# For other CUDA versions or CPU-only, see: https://pytorch.org/get-started/locally/
#
# VERIFIED VERSIONS (from PYTORCH_ENVIRONMENT_FIX_REPORT.md):
#   - torch==2.5.1+cu121
#   - torchvision==0.20.1+cu121
#   - torchaudio==2.5.1+cu121
#   - Python 3.12.12
#   - CUDA 12.1
# ===========================================================================================

# TensorRT for optimized inference (optional but recommended)
# Note: Install tensorrt separately with: pip install tensorrt~=8.6.0 --index-url https://pypi.nvidia.com
# tensorrt>=8.6.0,<9.0.0  # Uncomment if NVIDIA index is configured

# ONNX for model conversion
onnx>=1.14.0
onnxruntime>=1.16.0  # ONNX runtime (use onnxruntime-gpu for GPU support)

# Core dependencies (version constraints aligned with setup.py)
numpy>=1.26,<2.0
librosa>=0.10,<0.11
soundfile>=0.12,<0.13
scipy>=1.12,<1.14
matplotlib>=3.7,<3.9

# Web framework dependencies
flask>=2.3,<3.0
flask-socketio>=5.3,<6.0
flask-cors>=4.0,<5.0
python-socketio>=5.10,<6.0

# Configuration and utilities
pyyaml>=6.0,<7.0
psutil>=5.9,<8.0
pynvml>=11.5,<12.0
websockets>=13.0,<14.0
aiohttp>=3.9,<4.0

# Audio processing and ML utilities
webrtcvad>=2.0,<3.0  # Voice activity detection
crepe>=0.0.12  # Pitch detection (CPU fallback)
# torchcrepe>=0.0.23,<0.1  # PyTorch-based CREPE (install after PyTorch if needed)
praat-parselmouth>=0.4.0  # Advanced audio analysis
pyrubberband>=0.3.0  # Pitch-preserving time stretch for singing voice augmentation
resemblyzer>=0.1.1  # Pre-trained speaker encoder for voice cloning (Apache-2.0 license)
noisereduce>=3.0.0  # Noise reduction
# NOTE: Install PyTorch with CUDA first; if PyTorch is already installed, run: pip install --no-deps demucs
demucs>=4.0.0,<5.0.0  # State-of-the-art music source separation (Meta/Facebook)

# Objective quality evaluation metrics
pystoi>=0.3.3  # Short-Time Objective Intelligibility measure
pesq>=0.0.4  # Perceptual Evaluation of Speech Quality
seaborn>=0.12,<0.13  # Statistical data visualization (for quality plots)
pyloudnorm>=0.1.0  # LUFS loudness normalization (ITU-R BS.1770-4)

# ===========================================================================================
# OPTIONAL: Spleeter Backend (NOT REQUIRED - Demucs is the primary backend)
# ===========================================================================================
# Spleeter: Fast music separation fallback (Deezer)
# NOTE: Spleeter and TensorFlow are OPTIONAL dependencies for an alternative separation backend.
#       The primary backend is Demucs (installed above). Only install if you need Spleeter.
#
# Installation:
#   pip install spleeter>=2.4.0,<3.0.0 tensorflow-cpu~=2.12.0  # CPU-only
#   pip install spleeter>=2.4.0,<3.0.0 tensorflow~=2.12.0      # GPU (requires matching CUDA/cuDNN)
#
# WARNING: TensorFlow adds ~500MB+ to install size and may conflict with PyTorch CUDA versions
# TensorFlow compatibility: 2.5.x - 2.13.x (2.14+ may have breaking changes)
# TensorFlow GPU support requires compatible CUDA/cuDNN - see TensorFlow docs for version matrix
#
# Uncomment the lines below ONLY if you want to use Spleeter as a fallback backend:
# spleeter>=2.4.0,<3.0.0
# tensorflow-cpu>=2.12.0,<2.14.0  # Use tensorflow-cpu for CPU-only (recommended to avoid conflicts)
# ===========================================================================================

# Development and testing
pytest>=7.4,<8.0
pytest-cov>=4.1,<5.0
black>=23.7,<24.0
isort>=5.12,<6.0

# GPU monitoring and profiling
nvitop>=1.3,<2.0
py3nvml>=0.2.0  # Alternative NVIDIA management library

# Build dependencies
ninja>=1.11.0
pybind11>=2.11.0
